<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <title>Salida digital DO0</title>
    <link rel="stylesheet" type="text/css" href="../styles/stylesToggle.css" />
  </head>

  <body>
    <!-- Imagen del logotipo -->
    <div class="logo-container">
      <img
        src="../images/logo.jpg"
        alt="Ejemplo de imagen"
        height="80"
        class="logo"
      />
    </div>
    <h1>Salida digital DO0</h1>
    <div class="button-container">
      <button id="activarButton">Activar</button>
      <button id="desactivarButton">Desactivar</button>
    </div>
    <div id="lamparaContainer">
      <img id="lampara" src="../images/lampara_off.jpg" alt="Lámpara apagada" />
    </div>
    <div id="mensajeContainer"></div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // URL del socket para el cliente y el servidor
        let mySocket = new WebSocket("ws://localhost:8080");

        // Variable para el estado de la lámpara (inicialmente apagada)
        var lamparaEncendida = false;

        // Eventos del socket
        mySocket.onopen = mySocketOpen;
        mySocket.onmessage = mySocketShowData;

        // Callbacks - Apertura
        function mySocketOpen() {
          mySocket.send("DO0");
        }

        // Callbacks - Datos
        function mySocketShowData(result) {
          // No deja borrar esta funcion
        }

        // Activar botón
        document
          .getElementById("activarButton")
          .addEventListener("click", function () {
            mySocket.send("DO01");
            mostrarMensaje("Salida encendida");
          });

        // Desactivar botón
        document
          .getElementById("desactivarButton")
          .addEventListener("click", function () {
            mySocket.send("DO00");
            mostrarMensaje("Salida apagada");
          });

        // Función para mostrar el mensaje debajo de los botones
        function mostrarMensaje(mensaje) {
          var mensajeContainer = document.getElementById("mensajeContainer");
          mensajeContainer.innerHTML = mensaje;
        }

        // Función para cambiar el estado de la lámpara
        function cambiarEstadoLampara(estado) {
          var lampara = document.getElementById("lampara");

          // Cambiar el estado de la lámpara y ajustar la apariencia
          if (estado === "1") {
            lamparaEncendida = true;
            lampara.src = "../images/lampara_on.jpg"; // Imagen encendida
          } else {
            lamparaEncendida = false;
            lampara.src = "../images/lampara_off.jpg"; // Imagen apagada
          }
        }

        // Callbacks - Cierre
        window.onbeforeunload = function () {
          mySocket.close();
        };
      });
    </script>
  </body>
</html>
